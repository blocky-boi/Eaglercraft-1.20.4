Thanks to Zixia chen for the original, this version is optimized for macos rather than windows.
